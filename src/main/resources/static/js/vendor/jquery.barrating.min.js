!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}((function(t){var e=function(){function e(){var e=this,n=function(n){return t.isNumeric(n)&&(n=Math.floor(n)),t('option[value="'+n+'"]',e.$elem)},i=function(){var i=e.options.initialRating;return i?n(i):t("option:selected",e.$elem)},a=function(){var n=e.$elem.find('option[value="'+e.options.emptyValue+'"]');return!n.length&&e.options.allowEmpty?(n=t("<option />",{value:e.options.emptyValue})).prependTo(e.$elem):n},r=function(t){var n=e.$elem.data("barrating");return void 0!==t?n[t]:n},o=function(t,n){null!==n&&"object"==typeof n?e.$elem.data("barrating",n):e.$elem.data("barrating")[t]=n},l=function(){return r("ratingText")},s=function(){return r("ratingValue")},u=function(){return r("userOptions").reverse?"nextAll":"prevAll"},d=function(t){n(t).prop("selected",!0),r("userOptions").triggerChange&&e.$elem.change()},c=function(){t("option",e.$elem).prop("selected",(function(){return this.defaultSelected})),r("userOptions").triggerChange&&e.$elem.change()},g=function(t){(t=t||l())==r("emptyRatingText")&&(t=""),e.options.showSelectedRating&&e.$elem.parent().find(".br-current-rating").text(t)},f=function(){e.$widget.find("a").removeClass((function(t,e){return(e.match(/(^|\s)br-\S+/g)||[]).join(" ")}))},p=function(){var n,i,a=e.$widget.find('a[data-rating-value="'+s()+'"]'),o=r("userOptions").initialRating,l=t.isNumeric(s())?s():0,d=function(t){return Math.round(Math.floor(10*t)/10%1*100)}(o);if(f(),a.addClass("br-selected br-current")[u()]().addClass("br-selected"),!r("ratingMade")&&t.isNumeric(o)){if(l>=o||!d)return;n=e.$widget.find("a"),(i=a.length?a[r("userOptions").reverse?"prev":"next"]():n[r("userOptions").reverse?"last":"first"]()).addClass("br-fractional"),i.addClass("br-fractional-"+d)}},h=function(n){n.on("click.barrating",(function(n){var i,a,u=t(this),c=r("userOptions");return n.preventDefault(),i=u.attr("data-rating-value"),a=u.attr("data-rating-text"),function(t){return!(!r("allowEmpty")||!r("userOptions").deselectable)&&s()==t.attr("data-rating-value")}(u)&&(i=r("emptyRatingValue"),a=r("emptyRatingText")),o("ratingValue",i),o("ratingText",a),o("ratingMade",!0),d(i),g(a),p(),c.onSelect.call(e,s(),l(),n),!1}))},m=function(e){e.on("mouseenter.barrating",(function(){var e=t(this);f(),e.addClass("br-active")[u()]().addClass("br-active"),g(e.attr("data-rating-text"))}))},v=function(e){e.on("touchstart.barrating",(function(e){e.preventDefault(),e.stopPropagation(),t(this).click()}))},b=function(t){h(t),e.options.hoverState&&(m(t),e.$widget.on("mouseleave.barrating blur.barrating",(function(){g(),p()})))},y=function(t){t.off(".barrating")},w=function(t){var n=e.$widget.find("a");r("userOptions").fastClicks&&v(n),t?(y(n),function(t){t.on("click.barrating",(function(t){t.preventDefault()}))}(n)):b(n)};this.show=function(){r()||(function(){var n=["br-wrapper"];""!==e.options.theme&&n.push("br-theme-"+e.options.theme),e.$elem.wrap(t("<div />",{class:n.join(" ")}))}(),function(){var t=i(),n=a(),r=t.val(),l=t.data("html")?t.data("html"):t.text(),s=null!==e.options.allowEmpty?e.options.allowEmpty:!!n.length,u=n.length?n.val():null,d=n.length?n.text():null;o(null,{userOptions:e.options,ratingValue:r,ratingText:l,originalRatingValue:r,originalRatingText:l,allowEmpty:s,emptyRatingValue:u,emptyRatingText:d,readOnly:e.options.readonly,ratingMade:!1})}(),e.$widget=function(){var n=t("<div />",{class:"br-widget"});return e.$elem.find("option").each((function(){var i,a,o,l;(i=t(this).val())!==r("emptyRatingValue")&&(a=t(this).text(),(o=t(this).data("html"))&&(a=o),l=t("<a />",{href:"#","data-rating-value":i,"data-rating-text":a,html:e.options.showValues?a:""}),n.append(l))})),e.options.showSelectedRating&&n.append(t("<div />",{text:"",class:"br-current-rating"})),e.options.reverse&&n.addClass("br-reverse"),e.options.readonly&&n.addClass("br-readonly"),n}(),e.$widget.insertAfter(e.$elem),p(),g(),w(e.options.readonly),e.$elem.hide())},this.readonly=function(t){"boolean"==typeof t&&r("readOnly")!=t&&(w(t),o("readOnly",t),e.$widget.toggleClass("br-readonly"))},this.set=function(t){var n=r("userOptions");0!==e.$elem.find('option[value="'+t+'"]').length&&(o("ratingValue",t),o("ratingText",e.$elem.find('option[value="'+t+'"]').text()),o("ratingMade",!0),d(s()),g(l()),p(),n.silent||n.onSelect.call(this,s(),l()))},this.clear=function(){var t=r("userOptions");o("ratingValue",r("originalRatingValue")),o("ratingText",r("originalRatingText")),o("ratingMade",!1),c(),g(l()),p(),t.onClear.call(this,s(),l())},this.destroy=function(){var t=s(),n=l(),i=r("userOptions");y(e.$widget.find("a")),e.$widget.remove(),e.$elem.removeData("barrating"),e.$elem.unwrap(),e.$elem.show(),i.onDestroy.call(this,t,n)}}return e.prototype.init=function(e,n){return this.$elem=t(n),this.options=t.extend({},t.fn.barrating.defaults,e),this.options},e}();t.fn.barrating=function(n,i){return this.each((function(){var a=new e;if(t(this).is("select")||t.error("Sorry, this plugin only works with select fields."),a.hasOwnProperty(n)){if(a.init(i,this),"show"===n)return a.show(i);if(a.$elem.data("barrating"))return a.$widget=t(this).next(".br-widget"),a[n](i)}else{if("object"==typeof n||!n)return i=n,a.init(i,this),a.show();t.error("Method "+n+" does not exist on jQuery.barrating")}}))},t.fn.barrating.defaults={theme:"",initialRating:null,allowEmpty:null,emptyValue:"",showValues:!1,showSelectedRating:!0,deselectable:!0,reverse:!1,readonly:!1,fastClicks:!0,hoverState:!0,silent:!1,triggerChange:!0,onSelect:function(t,e,n){},onClear:function(t,e){},onDestroy:function(t,e){}},t.fn.barrating.BarRating=e}));